# CVE-2025-24071
Microsoft Windows File Explorer Spoofing Vulnerability

# Description
Exposure of sensitive information to an unauthorized actor in Windows File Explorer allows an unauthorized attacker to perform spoofing over a network.

CVE-2025-24071 resides in `windows.storage.dll`. The vulnerability exists because Windows File Explorer implicitly trusts and automatically parses "Parsing Names" and "Icon Paths" within Library Description files (`.library-ms`) without verifying the security zone of the path. 

When File Explorer attempts to resolve these paths (to display an icon or initialize a library location), it triggers an outbound SMB connection to the attacker's UNC path, resulting in an immediate NetNTLM hash leak.

# Affected versions
Windows 10 and earlier versions
Windows 11 (versions without the latest updates installed)
Windows Server 2016/2019/2022 (versions without the latest updates installed)

# Usage
Attacker:Linux# CVE-2025-24071
Microsoft Windows File Explorer Spoofing Vulnerability

# Description
Exposure of sensitive information to an unauthorized actor in Windows File Explorer allows an unauthorized attacker to perform spoofing over a network.

CVE-2025-24071 resides in `windows.storage.dll`. The vulnerability exists because Windows File Explorer implicitly trusts and automatically parses "Parsing Names" and "Icon Paths" within Library Description files (`.library-ms`) without verifying the security zone of the path. 

When File Explorer attempts to resolve these paths (to display an icon or initialize a library location), it triggers an outbound SMB connection to the attacker's UNC path, resulting in an immediate NetNTLM hash leak.

# Affected versions
Windows 10 and earlier versions  
Windows 11 (versions without the latest updates installed)  
Windows Server 2016/2019/2022 (versions without the latest updates installed)

# Usage
Attacker:Linux  
Target:Windows 10

```shell
>>python3 poc.py
>>enter file name: your file name
>>enter IP: attacker IP
```

Trigger the vulnerabilityï¼š  
Transfer exploit.zip to the target Windows system  
Unzip the ZIP file on Windows (key point: the extraction itself can trigger the vulnerability, no need for the user to double-click to open the file)


# Root Cause Analysis
The vulnerability is rooted in the function `CLocationDescription::_GetItemFromParsingName`. In unpatched versions of `windows.storage.dll`, the function retrieves a string from a property store and passes it directly to `_GetItemFromPath` without any trust or policy gate.

# References
[cve.org](https://www.cve.org/CVERecord?id=CVE-2025-24071)  
[MRSC](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071)  
[blog1](https://blog.csdn.net/weixin_42773448/article/details/146436061)  
[blog2](https://cloud.tencent.com/developer/article/2549756)  

Target:Windows 10

```shell
>>python3 poc.py
>>enter file name: your file name
>>enter IP: attacker IP
```

Trigger the vulnerability  
Transfer exploit.zip to the target Windows system  
Unzip the ZIP file on Windows (key point: the extraction itself can trigger the vulnerability, no need for the user to double-click to open the file)

# Demo
Windows 10
![alt text](image.png)

Linux
![alt text](image-1.png)
The captured NTLMv2 hash can be observed in the Responder output:
![alt text](image-2.png)

# Root Cause Analysis
The vulnerability is rooted in the function `CLocationDescription::_GetItemFromParsingName`. In unpatched versions of `windows.storage.dll`, the function retrieves a string from a property store and passes it directly to `_GetItemFromPath` without any trust or policy gate.

# References
[cve.org](https://www.cve.org/CVERecord?id=CVE-2025-24071)
[MRSC](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071)
[blog1](https://blog.csdn.net/weixin_42773448/article/details/146436061)
[blog2](https://cloud.tencent.com/developer/article/2549756)